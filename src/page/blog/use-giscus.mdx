---
title: ä½¿ç”¨ giscus ä¸ºé™æ€åšå®¢æ·»åŠ è½»é‡è¯„è®ºç³»ç»Ÿ
date: 2026-01-20 10:00:00
type: note
duration: 10min
---

è¿‘æœŸæˆ‘çš„åšå®¢åŸºç¡€åŠŸèƒ½å·²åŸºæœ¬å®Œæˆï¼Œä½†ä¸€ç›´å¸Œæœ›æ·»åŠ è¯„è®ºäº’åŠ¨åŠŸèƒ½ã€‚æœ€åˆè€ƒè™‘è¿‡åŸºäº Next.js ç¼–å†™å®Œæ•´çš„è¯„è®º APIï¼Œä½†è¿™ä¼šå¸¦æ¥ä¸å°çš„å¼€å‘è´Ÿæ‹…ï¼š

- éœ€è¦æ­å»ºæ•°æ®åº“å­˜å‚¨è¯„è®º
- è®¾è®¡è¯„è®ºå‰åç«¯äº¤äº’é€»è¾‘
- å¤„ç†ç”¨æˆ·èº«ä»½éªŒè¯ä¸åƒåœ¾è¯„è®ºé˜²èŒƒ
- é•¿æœŸç»´æŠ¤æœåŠ¡å™¨æˆæœ¬

ç”±äºæˆ‘çš„ç½‘ç«™æ˜¯é™æ€ç”Ÿæˆï¼Œæœ¬èº«ä¸å…·å¤‡æœåŠ¡å™¨å’Œæ•°æ®åº“ï¼Œå› æ­¤æˆ‘å¼€å§‹å¯»æ‰¾æ›´è½»é‡ã€å…åç«¯æ–¹æ¡ˆã€‚æœ€ç»ˆå‘ç°äº† [giscus](https://giscus.app/zh-CN)

ä¸€ä¸ªåŸºäº GitHub Discussions æ„å»ºçš„å¼€æºè¯„è®ºç³»ç»Ÿï¼Œè®©è®¿å®¢èƒ½ç›´æ¥é€šè¿‡ GitHub è´¦æˆ·åœ¨ç½‘ç«™ä¸Šç•™è¨€äº’åŠ¨ã€‚

### ğŸŒŸ ä¸ºä»€ä¹ˆé€‰æ‹© giscusï¼Ÿ

- å¼€æºã€‚ğŸŒ
- æ— è·Ÿè¸ªï¼Œæ— å¹¿å‘Šï¼Œæ°¸ä¹…å…è´¹ã€‚ğŸ“¡ ğŸš«
- æ— éœ€æ•°æ®åº“ã€‚æ‰€æœ‰æ•°æ®å‡å‚¨å­˜åœ¨ GitHub Discussions ä¸­ã€‚:octocat:
- æ”¯æŒ[è‡ªå®šä¹‰ä¸»é¢˜](https://github.com/giscus/giscus/blob/main/ADVANCED-USAGE.md#data-theme)ï¼ğŸŒ—
- æ”¯æŒå¤šç§[è¯­è¨€](https://github.com/giscus/giscus/blob/main/CONTRIBUTING.md#adding-localizations)ã€‚ğŸŒ
- [é«˜å¯é…ç½®æ€§](https://github.com/giscus/giscus/blob/main/ADVANCED-USAGE.md)ğŸ”§
- è‡ªåŠ¨ä» GitHub æ‹‰å–æ–°è¯„è®ºä¸ç¼–è¾‘ğŸ”ƒ
- å¯è‡ªå»ºæœåŠ¡ï¼ğŸ¤³

> æ³¨æ„ï¼š
> `giscus` ä»å¤„äºæ´»è·ƒå¼€å‘ä¸­ï¼ŒGitHub ä¹Ÿè¿˜åœ¨æ´»è·ƒåœ°å¼€å‘ `Discussions` åŠå…¶ APIï¼Œå› æ­¤ä¸€äº› `giscus` çš„ç‰¹æ€§å¯èƒ½éšæ—¶é—´æŸåæˆ–å˜æ›´ã€‚

### å®ƒå¦‚ä½•è¿ä½œ

`giscus` åŠ è½½æ—¶ï¼Œä¼šä½¿ç”¨ `GitHub Discussions` æœç´¢ API æ ¹æ®é€‰å®šçš„æ˜ å°„æ–¹å¼ï¼ˆå¦‚ `URL`ã€`pathname`ã€`<title>` ç­‰ï¼‰æ¥æŸ¥æ‰¾ä¸å½“å‰é¡µé¢å…³è”çš„ `discussion`ã€‚å¦‚æœæ‰¾ä¸åˆ°åŒ¹é…çš„ `discussion`ï¼Œ`giscus` bot å°±ä¼šåœ¨ç¬¬ä¸€æ¬¡æœ‰äººç•™ä¸‹è¯„è®ºæˆ–å›åº”æ—¶è‡ªåŠ¨åˆ›å»ºä¸€ä¸ª `discussion`ã€‚

è®¿å®¢å¦‚æœæƒ³è¦è¯„è®ºï¼Œå¿…é¡»æŒ‰ç…§ `GitHub OAuth` æµç¨‹æˆæƒ `giscus app` ä»£è¡¨ä»–å‘å¸ƒï¼Œæˆ–è€…å¯ä»¥ç›´æ¥åœ¨ `GitHub Discussion` é‡Œè¯„è®ºã€‚ä½ å¯ä»¥åœ¨ `GitHub` ä¸Šç®¡ç†è¯„è®ºã€‚

å¦‚æœä½ çš„åšå®¢ä¹Ÿéœ€è¦è¿™ç§è¯„è®ºç»„ä»¶ï¼Œæˆ‘éå¸¸å»ºè®®ä½ å»è¯•è¯•ï¼

### ğŸ“¦ å®ç°æ­¥éª¤

1. åˆ›å»º Giscus å®¢æˆ·ç«¯ç»„ä»¶

```tsx
"use client";

import { useEffect, useRef } from "react";

export default function Giscus({
  theme,
  mapping,
}: {
  theme: "light" | "dark";
  mapping: "pathname" | "url";
}) {
  const ref = useRef<HTMLDivElement>(null);

  useEffect(() => {
    if (!ref.current) return;

    ref.current.innerHTML = "";

    const script = document.createElement("script");
    script.src = "https://giscus.app/client.js";
    script.async = true;
    script.crossOrigin = "anonymous";

    script.setAttribute("data-repo", "zeroanonx/itSMe");
    script.setAttribute("data-repo-id", "R_kgDOQg6mxQ");
    script.setAttribute("data-category", "Announcements");
    script.setAttribute("data-category-id", "DIC_kwDOQg6mxc4C1OGn");

    script.setAttribute("data-mapping", mapping);
    script.setAttribute("data-theme", theme);
    script.setAttribute("data-lang", "zh-CN");
    script.setAttribute("data-input-position", "top");
    script.setAttribute("data-reactions-enabled", "1");

    ref.current.appendChild(script);
  }, [theme, mapping]);

  return <div ref={ref} className="mt-16" />;
}
```

2. å°è£…è¯„è®ºåŒºåŸŸç»„ä»¶

```tsx
"use client";

import { useGiscus } from "@/app/hooks";
import Giscus from "../others/Giscus";

export default function Comments() {
  const { theme, mapping, key } = useGiscus();
  // é¦–é¡µä¸éœ€è¦
  if (key === "/") return null;

  return (
    <section key={key} aria-label="Comments">
      <Giscus theme={theme} mapping={mapping} />
    </section>
  );
}
```

3. å®ç°ä¸»é¢˜åŒæ­¥ Hook

```tsx
"use client";

import { usePathname } from "next/navigation";
import { useEffect, useState } from "react";

export function useGiscus() {
  const pathname = usePathname();
  const [theme, setTheme] = useState<"light" | "dark">("dark");

  // è·Ÿéš Tailwind / next-themes
  useEffect(() => {
    const isDark = document.documentElement.classList.contains("dark");
    setTheme(isDark ? "dark" : "light");

    const observer = new MutationObserver(() => {
      const isDark = document.documentElement.classList.contains("dark");
      setTheme(isDark ? "dark" : "light");
    });

    observer.observe(document.documentElement, {
      attributes: true,
      attributeFilter: ["class"],
    });

    return () => observer.disconnect();
  }, []);

  return {
    theme,
    mapping: "pathname" as const,
    key: pathname,
  };
}
```

4. åœ¨ MDX å¸ƒå±€ä¸­ä½¿ç”¨

æœ€åï¼Œåªéœ€åœ¨åšå®¢æ–‡ç« å¸ƒå±€ç»„ä»¶ä¸­å¼•å…¥ `<Comments />` ç»„ä»¶å³å¯ã€‚

è¿™å¥—æ–¹æ¡ˆå°†è¯„è®ºæ•°æ®å®Œå…¨æ‰˜ç®¡äº GitHubï¼Œæ—¢ä¿æŒäº†é™æ€ç«™ç‚¹çš„è½»é‡ç‰¹æ€§ï¼Œåˆå®ç°äº†å®Œæ•´çš„è¯„è®ºäº¤äº’ã€‚å¦‚æœä½ çš„åšå®¢ä¹ŸåŸºäºé™æ€ç”Ÿæˆï¼Œä¸å¦¨å°è¯•è¿™ä¸ªä¼˜é›…çš„è§£å†³æ–¹æ¡ˆï¼
